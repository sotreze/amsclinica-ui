<div class="container">
    <form autocomplete="off" (ngSubmit)="salvar()" [formGroup]="formulario">
  
      <div class="ui-g">
        <div id="title" class="ui-g-12">
          <h2>{{ editando ? 'Edição de ' : 'Nova' }} Solicitação - AMS Clínica</h2>
  
        </div>

        <div class="ui-g-12">
          <p-selectButton name="tipo" [options]="tipos"
            formControlName="tipo"></p-selectButton>
        </div>

        <div class="ui-g-12 ui-md-6 ui-fluid" formGroupName="agenda">
           <label>Agenda</label>
            <p-dropdown name="agenda" [options]="agendas"
              placeholder="Selecione" [autoWidth]="false"  [filter]="true"
              formControlName="codigo"></p-dropdown>
        </div>
  
        <div class="ui-g-12 ui-md-6 ui-fluid" formGroupName="paciente">
            <label>Paciente</label>
            <p-dropdown name="paciente" [options]="pacientes"
              placeholder="Selecione" [autoWidth]="false"  [filter]="true"
              formControlName="codigo"></p-dropdown>
        </div>
  
        <div class="ui-g-12 ui-fluid">
            <label>Descrição</label>
            <p-editor name="descricao"
            formControlName="descricao" [style]="{'height':'320px'}" styleClass="editor-dimensions"
            ></p-editor>
            <app-message [control]="formulario.get('descricao')" error="obrigatoriedade"
            text="Descricão obrigatória"></app-message>
        </div>
  
        <div class="ui-g-6 ui-g-offset-6 ui-md-2 ui-md-offset-10 ui-fluid" 
        *ngIf="!formulario.get('anexo').value">
          <p-fileUpload name="anexo" mode="basic" auto="true" maxFileSize="100000000"
            chooseLabel="Anexar" accept="image/*,application/*"
            [url]="urlUploadAnexo"
            (onBeforeSend)="antesUploadAnexo($event)"
            (onUpload)="aoTerminarUploadAnexo($event)"
            (onError)="erroUpload($event)"
            [hidden]="uploadEmAndamento"></p-fileUpload>
  
          <p-progressSpinner [hidden]="!uploadEmAndamento"
            [style]="{ width: '25px', height: '25px' }"></p-progressSpinner>
        </div>
  
        <div class="ui-g-12" dir="rtl"
          *ngIf="formulario.get('anexo').value">
          <button pButton type="button" class="ui-button-danger"
          icon="fa-close" pTooltip="Remover anexo" tooltipPosition="top"
          (click)="removerAnexo()"></button>
  
          <a target="_blank" pTooltip="Baixar anexo" tooltipPosition="top"
            [href]="formulario.get('urlAnexo').value">{{ nomeAnexo }}</a>
        </div>
  
        <div class="ui-g-12">
          <button pButton type="submit" label="Salvar" [disabled]="formulario.invalid || uploadEmAndamento"></button>
          <button pButton type="button" label="Nova" class="ui-button-info"
          (click)="nova()"></button>
          <a routerLink="/agendas/nova">Voltar para o agendamento</a>
        </div>
      </div>
  
    </form>
  </div>

  